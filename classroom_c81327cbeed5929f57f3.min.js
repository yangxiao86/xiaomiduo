var vf;((vf=void 0===vf?{}:vf).gui=vf.gui||{}).module=function(){"use strict";var t={86:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.AcitonConsole=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text="",e}return n(e,t),e.prototype.onExecute=function(){console.log("vf - >执行输入内容",this.text),this.finish()},e}(o(627).Action);e.AcitonConsole=r},296:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionChangePage=void 0;var r=o(627),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=-1,e}return n(e,t),e.prototype.onExecute=function(){this.goPage()},e.prototype.goPage=function(){-1===this.page?this.status.currentPage=this.status.currentPage+1:this.status.currentPage=this.page,console.log("vf - >执行翻页",this.status.currentPage),this.controller.sendServer({level:"finish",method:"step"},{frameId:0,pageId:this.status.currentPage,score:-1,stepId:-1}),this.controller.dispatch({code:r.EventList.changePage,data:{page:this.status.currentPage},level:"command"}),console.log("vf - >执行翻页完成",this.status.currentPage),this.finish()},e}(r.Action);e.ActionChangePage=s},829:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionCounter=e.$Counter=void 0;var r=o(627);e.$Counter=[0];var s=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.runCount=0,e}return n(o,t),o.prototype.onExecute=function(){console.log("vf - > 计数器",e.$Counter),e.$Counter[0]++,e.$Counter[0]<this.runCount&&(this.gotoStep=void 0),this.finish()},o}(r.Action);e.ActionCounter=s},285:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionCoursewareClick=void 0;var r=o(627);var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.path=[],e}return n(e,t),e.prototype.onExecute=function(){console.log("vf - >执行点击",this.path),this.goClick()},e.prototype.goClick=function(){var t,e,o,i,n,s;this.controller.dispatch({level:"command",code:r.EventList.sendSignal,data:{signalList:(t=this,e=t.status.currentPage,o=t.status.syncId,i=t.status.syncId,n=performance.now(),s=JSON.stringify(t.path),[{name:"Page"+e+"_syncInteraction_"+o,val:{code:"syncInteraction_"+o,time:n,data:'{"type":"mousedown","path":'+s+',"data":{"identifier":1,"global":{"x":941,"y":1017}}}',role:"T",id:o}},{name:"Page"+e+"_syncInteraction_"+i,val:{code:"syncInteraction_"+i,time:n+34,data:'{"type":"mouseup","path":'+s+',"data":{"identifier":1,"global":{"x":941,"y":1017}}}',role:"T",id:i}}])}}),console.log("vf - >执行点击完成",this.path),this.finish()},e}(r.Action);e.ActionCoursewareClick=s},371:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionCoursewareDrag=void 0;var r=o(627),s=o(100);function a(t,e,o){void 0===o&&(o=1);var i=t.status.currentPage,n=Math.floor(performance.now()-t.status.changePageTime),s=JSON.stringify(t.path),a=t.beginPos,c=t.endPos,u=t.status.syncId,l={};switch(e){case"start":l={name:"Page"+i+"_syncInteraction_"+u,val:{code:"syncInteraction_"+u,time:n,data:'{"type":"touchstart","path":'+s+',"data":{"identifier":1,"global":{"x":'+a.x+',"y":'+a.y+"}}}",role:"T",id:u}};break;case"move":l={name:"Page"+i+"_syncInteraction_"+u,val:{code:"syncInteraction_"+u,time:n,data:'{"type":"touchmove","path":[],"data":{"identifier":1,"global":{"x":'+Math.ceil((c.x-a.x)*o+a.x)+',"y":'+Math.ceil((c.y-a.y)*o+a.y)+"}}}",role:"T",id:u}};break;case"end":l={name:"Page"+i+"_syncInteraction_"+u,val:{code:"syncInteraction_"+u,time:n,data:'{"type":"touchend","path":[],"data":{"identifier":1,"global":{"x":'+c.x+',"y":'+c.y+"}}}",role:"T",id:u}}}t.controller.dispatch({level:"command",code:r.EventList.sendSignal,data:{signalList:[l]}})}var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.path=[],e.beginPos={x:0,y:0},e.endPos={x:0,y:0},e.now=-1,e.timedelay=30,e.startTime=-1,e.timer=1e3,e}return n(e,t),e.prototype.onExecute=function(){console.error("vf - >执行拖拽",this.path,this.now,performance.now()),a(this,"start")},e.prototype.onupdate=function(t){if(this.state!==s.ActionState.Disabled){var e=performance.now();-1===this.now&&(this.now=e+this.timer,this.startTime=e),this.now<e?(this.now=1/0,this.finish(),a(this,"end")):e>=this.startTime&&(this.startTime=e+this.timedelay,a(this,"move",(e-this.now+this.timer)/this.timer))}},e}(r.Action);e.ActionCoursewareDrag=c},27:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.POINTER_TYPES=e.ActionCursewareClickEvent=e.$completedCLick=void 0;var r=o(627);e.$completedCLick=[];var s,a=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.keys=[],e.path=[],e.role="S",e.now=0,e.runCount=0,e.isAllComplete=!0,e.interactiveAction=!0,e.showPointerGuild=!0,e.isClick=!1,e}return n(o,t),o.prototype.onExecute=function(){var t=this;if(console.log("vf - >监听点击",this.path,this.keys),this.path.length>0&&this.keys.push({key:JSON.stringify(this.path)}),e.$completedCLick.length>0&&(this.keys.forEach((function(o){-1===e.$completedCLick.indexOf(o.key)&&(t.isAllComplete=!1)})),this.isAllComplete))return this.faileds=void 0,this.now=1/0,void this.finish();this.showPointerGuild&&this.createPointerGuild(),this.controller.subscribe(r.EventList.coursewareClickEvent,this.onClickEvent,this),this.sendServer("interactStart"),this.time&&(this.now=performance.now()+this.time)},o.prototype.sendServer=function(t,e){void 0===e&&(e=0),this.controller.sendServer({level:"click",method:t},{frameId:0,pageId:this.status.currentPage,score:e,stepId:this.curStep||0})},o.prototype.onClickEvent=function(t){this.isClick=this.search(t.data),this.isClick&&this.sendServer("interactStop",100),this.finish()},o.prototype.search=function(t){if("S"===this.role)for(var o=0;o<this.keys.length;o++)if(-1!==t.indexOf(this.keys[o].key))return e.$completedCLick.push(this.keys[o].key),this.keys[o].gotoStep&&(this.gotoStep=this.keys[o].gotoStep),!0;return!1},o.prototype.clickTimeOut=function(){this.gotoStep=this.timeOutGoto,this.sendServer("interactStop",0),this.finish()},o.prototype.onupdate=function(){this.time&&this.now<performance.now()&&(console.log("vf->监听点击超时完成",this.time),this.now=1/0,this.clickTimeOut())},o.prototype.getCurKey=function(){for(var t=0;t<this.keys.length;t++)if(-1===e.$completedCLick.indexOf(this.keys[t].key))return this.keys[t]},o.prototype.createPointerGuild=function(){var t=this.getCurKey(),e=this.stage.getChildByPath((null==t?void 0:t.path)||[]),o=e?vf.gui.Utils.toGlobal(new vf.Point(0,0),e):new vf.Point(0,0),i=(null==t?void 0:t.pos)?null==t?void 0:t.pos:[0,0];this.pointer=new c({type:s.POINTER_CLICK,timeArr:[{textureId:1,time:400},{textureId:2,time:200}]}),this.pointer.scaleX=this.pointer.scaleY=.5,this.pointer.visible=!0,this.pointer.interactabled=!1,this.pointer.setPosition(o.x/this.stage.scaleX+ +i[0],o.y/this.stage.scaleY+ +i[1]),this.stage.addChild(this.pointer)},o.prototype.doFinish=function(o){if(console.log("vf - >监听点击完成",this.path),this.controller.unSubscribe(r.EventList.coursewareClickEvent,this.onClickEvent,this),this.pointer&&(this.pointer.parent&&this.pointer.parent.removeChild(this.pointer),this.pointer.destroy(),this.pointer=void 0),!o&&this.faileds&&!this.isClick&&(this.faileds.click++,console.log("vf - >监听点击失败次数",this.faileds.click,this.runCount),this.faileds.click>this.runCount)){this.gotoStep=void 0;for(var i=0;i<this.keys.length;i++)if(-1===e.$completedCLick.indexOf(this.keys[i].key))return this.search(this.keys[i].key),void t.prototype.doFinish.call(this,o)}else t.prototype.doFinish.call(this,o)},o}(r.Action);e.ActionCursewareClickEvent=a,function(t){t.POINTER_CLICK="CLICK",t.POINTER_MOVE="MOVE"}(s=e.POINTER_TYPES||(e.POINTER_TYPES={}));var c=function(t){function e(e){var o=t.call(this)||this;return o._textureArr=[],o._timeArr=e.timeArr,o._pointerType=e.type,o._pathArr=e.movePath||[],o._anchorPoint=e.anchorPoint||new vf.Point(.5,.5),o._formatTexArr(),o._init(),o}return n(e,t),e.prototype._formatTexArr=function(){var t,e=this;null===(t=this._timeArr)||void 0===t||t.forEach((function(t){var o=1===t.textureId?"assets/button/c_pointer.png":"assets/button/c_pointer2.png";e._textureArr.push({texture:o,time:t.time})}))},e.prototype._init=function(){var t=this;if(this._pointer=new vf.gui.SpriteAnimated,this._pointer.anchorX=this._anchorPoint.x,this._pointer.anchorY=this._anchorPoint.y,this._pointer.src=this._textureArr,this._pointer.animationSpeed=1,this._pointer.loop=!0,this.addChild(this._pointer),this._pointerType===s.POINTER_MOVE){if(!this._pathArr)return;this._timeline=new vf.gui.TimeLine({repeat:-1});var e={x:this._pointer.x,y:this._pointer.y},o=0;this._pathArr.forEach((function(i){var n;null===(n=t._timeline)||void 0===n||n.to(e,i.duration,{x:i.x,y:i.y,ease:vf.gui.Easing.Linear.None,onUpdate:function(){t._pointer&&(t._pointer.x=e.x,t._pointer.y=e.y)}},o),o+=i.duration}))}this._pointer.play()},e.prototype.destroy=function(){this._timeline&&(this._timeline.removeAllListeners(),this._timeline.release()),this._timeline=void 0,this._pointer&&(this._pointer.stop(),this._pointer.release(),this._pointer=void 0),this._textureArr.length=0},e}(vf.gui.Container)},178:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionCursewareSoundEnd=void 0;var r=o(627),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e.time=2e4,e.now=0,e}return n(e,t),e.prototype.onExecute=function(){console.log("vf - >开始监听课件音频播放结束",this.key),this.controller.subscribe(r.EventList.coursewareSoundEnd,this.onSoundEnd,this),this.now=performance.now()+this.time},e.prototype.onSoundEnd=function(t){var e=this,o=!1,i=t.data;i&&i.forEach((function(t){-1!==t.content.indexOf(e.key)&&(o=!0)})),o&&this.finish()},e.prototype.doFinish=function(e){console.log("vf - >完成监听课件音频播放结束",this.key),this.controller.unSubscribe(r.EventList.coursewareSoundEnd,this.onSoundEnd,this),t.prototype.doFinish.call(this,e)},e.prototype.onupdate=function(){this.now<performance.now()&&(console.log("vf->定时器结束执行",this.time),this.now=1/0,this.finish())},e}(r.Action);e.ActionCursewareSoundEnd=s},903:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionExit=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text="未能正常互动，课程停止～",e}return n(e,t),e.prototype.onExecute=function(){var t;this.stage.releaseAll(),null===(t=this.controller.ws)||void 0===t||t.release(),vf.gui.Alert.show(this.stage,this.text,void 0,999999),console.log("vf - >退出课堂"),this.finish()},e}(o(951).Action);e.ActionExit=r},334:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ActionFace=void 0;var a=o(627),c=o(409),u=o(299),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._now=0,e.time=5e3,e.maxTime=6e4,e.failedCode=0,e.faceTime=0,e.checkList=[function(t){return performance.now()>t._now&&(t.failedCode=1,t.actionVideo&&(t.actionVideo.url="p00-s01.mp4",t.actionVideo.execute()),!0)},function(t){var e;return performance.now()>t._now+t.maxTime&&(t.failedCode=2,t.actionVideo&&(t.stage.releaseAll(),null===(e=t.controller.ws)||void 0===e||e.release(),vf.gui.Alert.show(t.stage,"未能识别人物，退出课堂",void 0,999999)),!0)}],e}return n(e,t),e.prototype.execute=function(){var e=this;console.log("vf - >人脸失败检测开始"),this.status.camera?c.Student.Ins.checkFace().then((function(o){if(o===a.FACESTATUS.FACEBACK)return console.log("vf - >人脸检测成功"),void e.finish();e.faceTime=0,e._now=performance.now()+e.time,e.actionVideo=a.getClassRoomObject(new u.ActionPlayVideo,e),t.prototype.execute.call(e)})):this.finish()},e.prototype.onupdate=function(){return r(this,void 0,void 0,(function(){var t=this;return s(this,(function(e){return-99==this.failedCode||(this.faceTime+=vf.Ticker.shared.deltaMS,this.faceTime>1e3&&(c.Student.Ins.checkFace().then(),this.faceTime=0),this.checkList.length>0&&this.checkList[0](this)&&this.checkList.shift(),1===this.failedCode&&this.status.isHaveFace===a.FACESTATUS.FACEBACK&&this.actionVideo&&(console.log("vf - >人脸检测成功"),this.actionVideo.url="p00-s02.mp4",this.actionVideo.execute(),this.failedCode=-99,setTimeout((function(){t.finish()}),8e3))),[2]}))}))},e.prototype.doFinish=function(e){this.actionVideo&&this.actionVideo.cancel(),t.prototype.doFinish.call(this,e)},e}(a.Action);e.ActionFace=l},60:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionInteractive=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.open=!0,e}return n(e,t),e.prototype.execute=function(){console.log("vf - >开启或关闭交互",this.open),this.stage.container.parent.interactiveChildren=this.open,this.finish()},e}(o(627).Action);e.ActionInteractive=r},911:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionNextStep=void 0;var r=o(627),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onExecute=function(){console.log("vf -> 执行下一步动作"),this.controller.sendServer({level:"finish",method:"step"},{frameId:0,pageId:this.status.currentPage,score:-1,stepId:this.curStep||0}),this.controller.dispatch({code:r.EventList.acitonByNextStep,level:"command",data:this}),this.finish()},e}(o(951).Action);e.ActionNextStep=s},299:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionPlayVideo=void 0;var r=o(895),s=o(627),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._url="",e.complateTime=0,e.openTimer=!1,e}return n(e,t),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(t){this._url=r.ClassRoom.Ins.getPath(t)},enumerable:!1,configurable:!0}),e.prototype.sendPlay=function(){this.controller.dispatch({code:s.EventList.videoByPlay,message:"播放视频",data:{urls:[this.url]},level:"command"})},e.prototype.onExecute=function(){var t=this;if(this.url){if(console.log("vf - >\b视频播放开始",this.url),!this.status.video)return void setTimeout((function(){t.finish()}),1e3);if(void 0===this.time?this.controller.subscribe(s.EventList.videoEnd,this.onVideoEnd,this):(this.controller.subscribe(s.EventList.videoEnd,this.onVideoEnd,this),this.controller.subscribe(s.EventList.videoStart,this.onVideoStart,this)),this.status.res[this.url])this.sendPlay();else{var e=this.status.$loader.getNewLoader();e.onComplete.once(this.onComplete,this),e.add(this.url,{loadType:vf.LoaderResource.LOAD_TYPE.XHR,xhrType:"arraybuffer"}),e.load()}}else this.controller.dispatch({code:s.EventList.log,message:"ActionPlayVideo -> url 不存在",data:void 0,level:"error"}),this.finish()},e.prototype.onComplete=function(t){this.state!==s.ActionState.Disabled&&(t.destroy(),this.sendPlay())},e.prototype.onVideoStart=function(t){this.state!==s.ActionState.Disabled&&t.data&&t.data.url===this.url&&this.time&&(this.complateTime=performance.now()+this.time,this.openTimer=!0)},e.prototype.onVideoEnd=function(t){this.state!==s.ActionState.Disabled&&t.data&&t.data.url===this.url&&(this.controller.unSubscribe(s.EventList.videoEnd,this.onVideoEnd,this),this.finish())},e.prototype.onupdate=function(){this.openTimer&&performance.now()>=this.complateTime&&this.finish()},e.prototype.doFinish=function(e){console.log("vf - >视频播放结束",this.url),this.openTimer=!1,this.controller.unSubscribe(s.EventList.videoStart,this.onVideoStart,this),this.controller.unSubscribe(s.EventList.videoEnd,this.onVideoEnd,this),t.prototype.doFinish.call(this,e)},e}(s.Action);e.ActionPlayVideo=a},662:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionRecorderFailed=void 0;var r=o(627),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scores=[],e.runCount=2,e._recordFailDiff=!0,e}return n(e,t),e.prototype.onExecute=function(){console.log("vf - >语音监听失败开始"),this.controller.subscribe(r.EventList.sendRecordResult,this.onRecordResult,this),this.controller.subscribe(r.EventList.recordError,this.onRecordError,this),this.controller.subscribe(r.EventList.recordTimeOut,this.onRecordError,this),this.controller.subscribe(r.EventList.sendRecordFailDiff,this.sendRecordFailDiff,this)},e.prototype.onRecordResult=function(t){t.data&&"number"==typeof t.data.score&&this.scores.length>0&&(this._recordFailDiff||0===t.data.tipId)&&t.data.score>=this.scores[0]&&t.data.score<=this.scores[1]&&this.finish()},e.prototype.sendRecordFailDiff=function(t){t&&t.data&&(this._recordFailDiff=t.data.mergeVoicelessAndFailed)},e.prototype.onRecordError=function(){this.state!==r.ActionState.Disabled&&this.finish()},e.prototype.doFinish=function(e){if(console.log("vf - >语音监听失败结束"),this.status.myotee=void 0,this.controller.unSubscribe(r.EventList.sendRecordResult,this.onRecordResult,this),this.controller.unSubscribe(r.EventList.recordError,this.onRecordError,this),this.controller.unSubscribe(r.EventList.recordTimeOut,this.onRecordError,this),this.controller.unSubscribe(r.EventList.sendRecordFailDiff,this.sendRecordFailDiff,this),!e&&this.faileds&&(this.faileds.recorder++,console.log("vf - >语音失败次数",this.faileds.recorder,this.runCount),this.faileds.recorder>this.runCount))return this.gotoStep=void 0,this.status.myotee=void 0,this.allFailedGotoStep?this.gotoStep=this.allFailedGotoStep:this.controller.dispatch({code:r.EventList.acitonByNextStep,data:this,level:"command"}),void t.prototype.doFinish.call(this,e);t.prototype.doFinish.call(this,e)},e}(r.Action);e.ActionRecorderFailed=s},74:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionRecorderStart=void 0;var r=o(627),s=o(390),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refText="",e.keyWords="",e.time=5e3,e.now=0,e._mergeVoicelessAndFailed=!0,e}return n(e,t),e.prototype.onExecute=function(){var t=this;return console.log("vf - >语音评测启动"),this.status.microphone?this.status.platform!==r.Platform.H5||s.Recorder.Ins.getReady()?(this.controller.dispatch({code:r.EventList.sendRecordFailDiff,data:{mergeVoicelessAndFailed:this._mergeVoicelessAndFailed},level:"command"}),this.controller.subscribe(r.EventList.recordState,this.onRecordState,this),s.Recorder.Ins.start(this.refText,this.keyWords),void(this.now=this.time+performance.now())):(console.log("vf - >语音评测启动失败"),void this.finish()):(console.log("vf - > 语音评测随机开始"),this.now=1/0,this.status.myotee={name:"mic",animationName:"mic"},void setTimeout((function(){t.controller.dispatch({code:r.EventList.sendRecordResult,data:{score:100*Math.random()},level:"command"}),t.finish()}),this.time))},e.prototype.onRecordState=function(t){t.data===s.RecorderStates.AUDIO_RECORDING&&(this.status.myotee={name:"mic",animationName:"mic"},this.now=this.time+performance.now())},e.prototype.onResult=function(){this.state!==r.ActionState.Disabled&&this.finish()},e.prototype.doFinish=function(e){console.log("vf - >语音评测启动并评测完成"),this.controller.unSubscribe(r.EventList.recordState,this.onRecordState,this),t.prototype.doFinish.call(this,e)},Object.defineProperty(e.prototype,"mergeVoicelessAndFailed",{get:function(){return this._mergeVoicelessAndFailed},set:function(t){this._mergeVoicelessAndFailed=t},enumerable:!1,configurable:!0}),e.prototype.onupdate=function(){this.now<performance.now()&&(console.log("vf - >\b语音评测失 超时",this.time),this.now=1/0,this.status.myotee=void 0,this.finish(),s.Recorder.Ins.stop())},e}(r.Action);e.ActionRecorderStart=a},148:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionRecorderSucess=void 0;var r=o(627),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scores=[-89],e}return n(e,t),e.prototype.onExecute=function(){console.log("vf - >语音监听成功开始"),this.controller.subscribe(r.EventList.sendRecordResult,this.onRecordResult,this)},e.prototype.sendServer=function(t,e){void 0===e&&(e=0),this.controller.sendServer({level:"eval",method:t},{frameId:0,pageId:this.status.currentPage,score:e,stepId:this.curStep||0})},e.prototype.onRecordResult=function(t){var e="";t.data&&t.data.tipId&&0!==t.data.tipId&&0===t.data.score&&(e="未发音"),console.log("vf - > 语音评分分数:"+t.data.score+" "+e),t.data&&"number"==typeof t.data.score&&t.data.score>=this.scores[0]&&t.data.score<=this.scores[1]&&(this.faileds&&(this.faileds.recorder=0),this.sendServer("interactStart",0),this.sendServer("interactStop",t.data.score),this.finish())},e.prototype.doFinish=function(e){console.log("vf - >语音监听成功结束"),t.prototype.doFinish.call(this,e),this.controller.unSubscribe(r.EventList.sendRecordResult,this.onRecordResult,this)},e}(r.Action);e.ActionRecorderSucess=s},212:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionRecorderVoiceless=void 0;var r=o(627),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.runCount=2,e._recordFailDiff=!0,e}return n(e,t),e.prototype.onExecute=function(){console.log("vf - >语音监听未发音 开始"),this.controller.subscribe(r.EventList.sendRecordResult,this.onRecordResult,this),this.controller.subscribe(r.EventList.recordError,this.onRecordError,this),this.controller.subscribe(r.EventList.recordTimeOut,this.onRecordError,this),this.controller.subscribe(r.EventList.sendRecordFailDiff,this.sendRecordFailDiff,this)},e.prototype.onRecordResult=function(t){t.data&&"number"==typeof t.data.score&&0===t.data.score&&0!==t.data.tipId&&!this._recordFailDiff&&this.finish()},e.prototype.onRecordError=function(){this.state!==r.ActionState.Disabled&&this.finish()},e.prototype.sendRecordFailDiff=function(t){t&&t.data&&(this._recordFailDiff=t.data.mergeVoicelessAndFailed)},e.prototype.doFinish=function(e){if(console.log("vf - >语音监听未发音 结束"),this.status.myotee=void 0,this.controller.unSubscribe(r.EventList.sendRecordResult,this.onRecordResult,this),this.controller.unSubscribe(r.EventList.recordError,this.onRecordError,this),this.controller.unSubscribe(r.EventList.recordTimeOut,this.onRecordError,this),this.controller.unSubscribe(r.EventList.sendRecordFailDiff,this.sendRecordFailDiff,this),!e&&this.faileds&&(this.faileds.voiceLess++,console.log("vf - >语音 未发音次数",this.faileds.voiceLess,this.runCount),this.faileds.voiceLess>this.runCount))return this.gotoStep=void 0,this.status.myotee=void 0,this.allViocelessGotoStep?this.gotoStep=this.allViocelessGotoStep:this.controller.dispatch({code:r.EventList.acitonByNextStep,data:this,level:"command"}),void t.prototype.doFinish.call(this,e);t.prototype.doFinish.call(this,e)},e}(r.Action);e.ActionRecorderVoiceless=s},544:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionResetCounter=void 0;var r=o(627),s=o(27),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clearClickListens=!1,e}return n(e,t),e.prototype.onExecute=function(){if(console.log("vf - >重置点击失败次数为0"),console.log("vf - >重置语音失败次数为0"),this.faileds)for(var t in this.faileds)this.faileds[t]=0;s.$completedCLick.length>0&&this.clearClickListens&&(s.$completedCLick.length=0),this.finish()},e}(r.Action);e.ActionResetCounter=a},320:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionScript6=void 0;var r=o(627),s=o(951),a=o(27),c=o(299),u=o(662),l=o(148),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text="未能正常互动，课程停止～",e.paths=["cardbg_0","cardbg_1","cardbg_2","cardbg_3"],e.index=0,e.indexs=[],e.process1=new r.Process,e.process2=new r.Process,e.settimeId=-1,e}return n(e,t),e.prototype.onExecute=function(){this.finish()},e.prototype.doFinish=function(e){t.prototype.doFinish.call(this,e),this.process1.offCompletedListener(this.onProcess1,this),this.process2.offCompletedListener(this.onProcess2,this)},e.prototype.init=function(){var t=this;if(this.process1.stop(),this.process1.clear(),this.process2.stop(),this.process2.clear(),this.cardsAction&&this.cardsAction.cancel(),4!==this.indexs.length){var e=this.cardsAction=r.getClassRoomObject(new a.ActionCursewareClickEvent,this);e.onCompletedListener(this.onClick,this),e.execute();var o=r.getClassRoomObject(new c.ActionPlayVideo,this);o.url="p08-s01.mp4",o.execute(),clearTimeout(this.settimeId),this.settimeId=setTimeout((function(){t.init()}),3e3)}else this.finish()},e.prototype.onClick=function(t){t||this.cardsAction},e.prototype.playAudio=function(t){if(void 0!==this.cardsAction){var e=r.getClassRoomObject(new c.ActionPlayVideo,this);e.url="p09-s02.mp4";var o=r.getClassRoomObject(new c.ActionPlayVideo,this);o.url=2===t||3==t?"p08-s03-b01.mp4":"p08-s03-b02.mp4",this.process1.add(this.cardsAction),this.process1.add(e),this.process1.add(o),this.process1.start()}},e.prototype.playRecorder=function(){var t=r.getClassRoomObject(new c.ActionPlayVideo,this);2===this.index||3==this.index?t.url="p08-s04-b01.mp4":t.url="p08-s04-b02.mp4";var e=r.getClassRoomObject(new u.ActionRecorderFailed,this);e.waitingToCompleted=!1,e.scores=[0,11];var o=r.getClassRoomObject(new l.ActionRecorderSucess,this);o.scores=[12,100];var i=r.getClassRoomObject(new c.ActionPlayVideo,this);1===this.index&&(i.url="p08-s06-b01.mp4"),2===this.index&&(i.url="p08-s06-b03.mp4"),3===this.index&&(i.url="p08-s06-b04.mp4"),4===this.index&&(i.url="p08-s06-b02.mp4"),this.process2.add(t),this.process2.add(e),this.process2.add(o),this.process2.add(i),this.process2.start()},e.prototype.onProcess1=function(){this.playRecorder()},e.prototype.onProcess2=function(){this.init()},e}(s.Action);e.ActionScript6=h},968:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ActionWaiting=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=5e3,e.now=0,e}return n(e,t),e.prototype.onExecute=function(){console.log("vf->等待执行开始",this.time),this.now=performance.now()+this.time},e.prototype.onupdate=function(){this.now<performance.now()&&(console.log("vf->等待执行结束",this.time),this.now=1/0,this.finish())},e}(o(627).Action);e.ActionWaiting=r},295:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ActionList=void 0;var a=o(627),c=o(502),u=o(296),l=o(829),h=o(895),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startProcess=new a.Process,e.customProcess=new a.Process,e.page=0,e.step=0,e.faileds={recorder:0,voiceLess:0,click:0},e}return n(e,t),e.prototype.startStartProcess=function(){return r(this,void 0,void 0,(function(){var t,e;return s(this,(function(o){for(e in this.clear(),t=this.jsonObj[this.page].stepList[this.step],c.processByJson(this,this.startProcess,t.start,this.faileds),this.faileds)this.faileds[e]=0;return this.startProcess.start(),[2]}))}))},e.prototype.startCustomProcess=function(t){this.clear();var e=this.jsonObj[this.page].stepList[this.step];if(this.customProcess.processName="customProcess:"+t,"string"==typeof t)c.processByJson(this,this.customProcess,e[t],this.faileds);else{e=e[t[0]];for(var o=[],i=Number(t[1]);i<e.length;i++)o.push(e[i]);c.processByJson(this,this.customProcess,e,this.faileds)}this.customProcess.start()},e.prototype.clear=function(){this.startProcess.clear(),this.customProcess.clear()},e.prototype.start=function(){return r(this,void 0,void 0,(function(){return s(this,(function(t){return this.jsonObj=this.status.pageDatas,h.ClassRoom.Ins.options.debug&&console.log("vf - >开始动作",this.page,this.step,this.jsonObj),c.$completedCLick.length=0,l.$Counter[0]=0,this.startStartProcess(),[2]}))}))},e.prototype.onCompletedListener=function(t){h.ClassRoom.Ins.options.debug&&console.log("vf->actionList onCompletedListener",t)},e.prototype.onAcitonByGotoProcess=function(t){this.clear();var e=t.data;switch(e.gotoStep){case void 0:console.warn("检查gotoProcess配置");break;default:this.startCustomProcess(e.gotoStep)}},e.prototype.onAcitonByNextStep=function(){this.clear(),this.step++,this.jsonObj[this.page].stepList[this.step]?(this.start(),h.ClassRoom.Ins.options.debug&&console.log("vf - >正常进行完成，继续下一步内容",this.page,this.step)):(this.status.currentPage&&(this.step=0),this.pageAction&&this.pageAction.execute())},e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){return s(this,(function(t){return this.pageAction=a.getClassRoomObject(new u.ActionChangePage,this),this.startProcess.processName="startProcess",this.customProcess.processName="customProcess",this.startProcess.onCompletedListener(this.onCompletedListener,this),this.customProcess.onCompletedListener(this.onCompletedListener,this),this.controller.subscribe(a.EventList.acitonByGotoProcess,this.onAcitonByGotoProcess,this),this.controller.subscribe(a.EventList.acitonByNextStep,this.onAcitonByNextStep,this),[2]}))}))},e.prototype.release=function(){this.clear(),this.controller.unSubscribe(a.EventList.acitonByGotoProcess,this.onAcitonByGotoProcess,this),this.controller.unSubscribe(a.EventList.acitonByNextStep,this.onAcitonByNextStep,this),this.startProcess.offCompletedListener(this.onCompletedListener,this),this.customProcess.offCompletedListener(this.onCompletedListener,this)},e}(a.ClassRoomObject);e.ActionList=d},502:function(t,e,o){var i=this&&this.__createBinding||(Object.create?function(t,e,o,i){void 0===i&&(i=o),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[o]}})}:function(t,e,o,i){void 0===i&&(i=o),t[i]=e[o]}),n=this&&this.__exportStar||function(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||i(e,t,o)};Object.defineProperty(e,"__esModule",{value:!0}),e.processByJson=void 0;var r=o(627),s=o(86),a=o(296),c=o(829),u=o(285),l=o(371),h=o(27),d=o(178),p=o(903),f=o(334),v=o(60),y=o(911),g=o(299),b=o(662),m=o(212),_=o(74),w=o(148),P=o(544),E=o(320),O=o(968),C={ActionCoursewareClick:u.ActionCoursewareClick,ActionCoursewareDrag:l.ActionCoursewareDrag,ActionExit:p.ActionExit,ActionWaiting:O.ActionWaiting,ActionCursewareClickEvent:h.ActionCursewareClickEvent,ActionCursewareSoundEnd:d.ActionCursewareSoundEnd,AcitonConsole:s.AcitonConsole,ActionNextStep:y.ActionNextStep,ActionScript6:E.ActionScript6,ActionPlayVideo:g.ActionPlayVideo,ActionChangePage:a.ActionChangePage,ActionFace:f.ActionFace,ActionRecorderSucess:w.ActionRecorderSucess,ActionRecorderFailed:b.ActionRecorderFailed,ActionRecorderVoiceless:m.ActionRecorderVoiceless,ActionRecorderStart:_.ActionRecorderStart,ActionResetCounter:P.ActionResetCounter,ActionInteractive:v.ActionInteractive,ActionCounter:c.ActionCounter};n(o(903),e),n(o(299),e),n(o(148),e),n(o(296),e),n(o(285),e),n(o(371),e),n(o(968),e),n(o(27),e),n(o(178),e),n(o(86),e),n(o(911),e),n(o(320),e),n(o(334),e),n(o(662),e),n(o(212),e),n(o(74),e),n(o(544),e),n(o(60),e),n(o(829),e),e.processByJson=function(t,e,o,i){return o.forEach((function(o){var n=function(t,e){var o,i=C[e.type];if(!i)throw new Error(e.type+" 无法找到行动类");o=r.getClassRoomObject(new i,t);for(var n in e)o[n]=e[n];return o}(t,o);n.faileds=i,n.curStep=t.step,e.add(n)})),e}},895:function(t,e,o){var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ClassRoom=void 0;var r=o(627),s=o(961),a=o(390),c=o(530),u=o(752),l=o(412),h=o(852),d=o(295),p=o(23),f=o(249),v=o(409),y=o(579),g=function(){function t(){if(this.publicPath="https://s.vipkidstatic.com/fe-static/vf-thunder",this.isProd=!0,this.lastPage=-1,this.status=void 0,this.controller=void 0,this.stage=void 0,t._ins)throw new Error("无法创建多个课堂！");t._ins=this}return Object.defineProperty(t,"Ins",{get:function(){return t._ins},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"courses",{get:function(){return{l1u7:{json:this.status.debugOption.jsonpath||this.getPath("index.json"),js:"https://s.vipkidstatic.com/fe-static/VF_Trail_AI_L1U7/index-2717361fff195.js"}}},enumerable:!1,configurable:!0}),t.prototype.setStatus=function(t,e,o){this.stage=t,this.status=e,this.controller=o,t.app.view.offsetTop<0&&(this.status.topOffset=t.app.view.offsetTop)},t.prototype.setStage=function(t,e){this.setStatus(t,new r.Status,new r.Controller(t)),e&&e.userId&&(this.status.userId=e.userId),e&&e.roomId&&(this.status.roomId=e.roomId),y.systemCheck(this.status,this.stage),this.onLoad()},t.prototype.onLoad=function(){this.connectWSS()},t.prototype.connectWSS=function(){this.isProd?(this.status.appId="f793db34561c11ebb7f947a3ed5af0b7",this.status.wss="wss://ai-wss.vipkid.com.cn/acs/api/v1",this.status.classId="1"):(this.status.appId="c409413e44fe11ebbf23e3862d551f69",this.status.wss="wss://stage-wss.vipkid-qa.com.cn/acs/api/v1",this.status.classId="123123",console.log("vf - > 测试环境")),this.controller.subscribe(r.EventList.wsInitComplete,this.onInitWsComplete,this),this.controller.ws=this.ws=this.getModule(new u.NetFlatBuffers),this.controller.sendServer({method:"init"},{})},t.prototype.onInitWsComplete=function(t){return i(this,void 0,void 0,(function(){var t,e,o=this;return n(this,(function(i){switch(i.label){case 0:return this.controller.unSubscribe(r.EventList.wsInitComplete,this.onInitWsComplete,this),[4,vf.utils.readFileSync(this.courses.l1u7.js,{}).catch((function(t){o.sendError(t)}))];case 1:return i.sent(),[4,vf.utils.readFileSync(this.courses.l1u7.json,{responseType:"json"}).catch((function(t){o.sendError(t)}))];case 2:return t=i.sent(),this.status.pageDatas=t,[4,this.createInitRes()];case 3:return i.sent(),[4,this.createTeacher()];case 4:return i.sent(),[4,this.createStudent()];case 5:return i.sent(),[4,this.createEnterButton()];case 6:return i.sent(),this.status.microphone?(e=void 0,this.status.platform!==r.Platform.WXH5?[3,9]:[4,vf.utils.readFileSync("https://stage-weixin.vipkid-qa.com.cn/wx/multi/open/js/getConfig?url=www.xiaomiduo.com&appNumber=wxbfe35c5b8847f62f",{responseType:"json"})]):[3,11];case 7:return e=i.sent(),[4,a.Recorder.Ins.setWXH5RecordConfig(e)];case 8:i.sent(),i.label=9;case 9:return[4,a.Recorder.Ins.init(this)];case 10:i.sent()?console.log("vf - 初始音视频权限完成"):console.log("vf - 初始音视频权限失败"),i.label=11;case 11:return[2]}}))}))},Object.defineProperty(t.prototype,"options",{get:function(){return this.engine.option},enumerable:!1,configurable:!0}),t.prototype.createInitRes=function(){var t=this;return new Promise((function(e){var o,i,n,r,s,a=t.publicPath,c={loadType:vf.LoaderResource.LOAD_TYPE.XHR,xhrType:"arraybuffer"},u=(null===(o=t.status.pageDatas[0])||void 0===o?void 0:o.commonImageList)||[],h=(null===(i=t.status.pageDatas[0])||void 0===i?void 0:i.commonVideoList)||[],d=(null===(n=t.status.pageDatas[t.status.currentPage])||void 0===n?void 0:n.videoList)||[];(null===(r=t.status.pageDatas[t.status.currentPage+1])||void 0===r?void 0:r.videoList)&&(d=d.concat(null===(s=t.status.pageDatas[t.status.currentPage+1])||void 0===s?void 0:s.videoList));var p=t.loading;p||(p=t.loading=t.getModule(new l.Loading)),t.status.res.mic||p.addRes("mic",a+"/assets/mic2.json"),t.status.res.video||p.addRes("video",a+"/assets/video.mp4",c),t.status.res.sound||p.addRes("sound",a+"/assets/sound.mp3",c),u.forEach((function(t){p&&p.addRes(t,t)})),h.forEach((function(e){!t.status.res[t.getPath(e)]&&p&&p.addRes(t.getPath(e),t.getPath(e),c)})),d.forEach((function(e){!t.status.res[t.getPath(e)]&&p&&p.addRes(t.getPath(e),t.getPath(e),c)})),p.onComplete=e,p.loadRes()}))},t.prototype.createTeacher=function(){var t=this.teacher=this.getModule(this.status.singleMovie?new f.MovieClipSingle:new p.MovieClip);t.width=320,t.height=240,t.y=0+this.status.topOffset,t.x=0,t.visible=!1,t.setDefaultUrl(this.getPath("p00-still-1s-v01.mp4")),c.setVideoRectMask(t,"rect",320,240),h.setVideoBg(t,"T")},t.prototype.createStudent=function(){var t=this;return new Promise((function(e){var o=t.student=t.getModule(v.Student.Ins);o.width=320,o.height=240,o.y=0+t.status.topOffset,o.x=0,o.visible=!1,o.once(v.Student.loadCompleteEvent,e,t),c.setVideoRectMask(o,"rect",320,240),h.setVideoBg(o,"S")}))},t.prototype.createPageRes=function(){var t=this;return new Promise((function(e){var o,i={loadType:vf.LoaderResource.LOAD_TYPE.XHR,xhrType:"arraybuffer"},n=(null===(o=t.status.pageDatas[t.status.currentPage])||void 0===o?void 0:o.videoList)||[],r=t.status.$loader.getNewLoader();r.onComplete.once(e,t),n.forEach((function(e){t.status.res[t.getPath(e)]||r.add(t.getPath(e),t.getPath(e),i)})),r.load()}))},t.prototype.createEnterButton=function(){var t;console.log("vf - 初始化资源数据完成"),this.enterButton=this.getModule(new s.EnterButton),this.enterButton.once(r.EventList.enterClassRoom,this.onEnterClassRoom,this),null===(t=this.loading)||void 0===t||t.release()},t.prototype.onEnterClassRoom=function(){var t,e;return i(this,void 0,void 0,(function(){return n(this,(function(o){switch(o.label){case 0:return null===(t=this.teacher)||void 0===t||t.play(this.getPath("p00-still-1s-v01.mp4")),this.actionList=this.getModule(new d.ActionList),this.courseware=this.getModule(new c.Courseware),this.courseware.on(r.EventList.coursewarePageLoaded,this.onCoursewarePageLoaded,this),[4,this.courseware.init("CourseWareClass",this.engine,this.student,this.teacher)];case 1:return o.sent(),console.log("vf - 初始课件完成"),this.stage.container.parent.interactiveChildren=!1,null===(e=this.enterButton)||void 0===e||e.release(),[2]}}))}))},t.prototype.onCoursewarePageLoaded=function(){return i(this,void 0,void 0,(function(){var t,e=this;return n(this,(function(o){switch(o.label){case 0:return t=Math.max(0,this.status.currentPage),this.lastPage===t?[2]:(this.lastPage=t,[4,this.createPageRes()]);case 1:return o.sent(),[4,setTimeout((function(){var o;null===(o=e.student)||void 0===o||o.checkMedia(),e.actionList&&(e.actionList.page=t,e.actionList.step=0,e.actionList.start())}),2e3)];case 2:return o.sent(),[2]}}))}))},t.prototype.getModule=function(t){var e=r.getClassRoomObject(t,this);return this.stage&&e instanceof vf.gui.DisplayObject&&this.stage.addChild(e),e},t.prototype.getPath=function(t){return t.length>0&&-1===t.indexOf("//")?this.publicPath+"/assets/l1u7-v4/"+t:t},t.prototype.sendError=function(t){t.level="error",this.controller.dispatch(t)},t}();e.ClassRoom=g},412:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Loading=void 0;var a=function(t){function e(){var e=t.call(this)||this;return e.w=500,e.h=20,e.c=5,e.tween=new vf.gui.Tween({}),e.slider=new vf.Graphics,e.sliderBG=new vf.Graphics,e.label=new vf.Text("loading... 100%",{fontSize:14,fill:16777215,align:"center"}),e.loader=void 0,e}return n(e,t),e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){var t,e,o,i,n,r,a,c,u;return s(this,(function(s){return t=this.w,e=this.h,o=this.stage.app.renderer.resolution,i=this.stage.app.view,n=this.stage.app.stage,(r=this.sliderBG).lineStyle(1,16777215),r.beginFill(16777215),r.drawRoundedRect(0,0,t,e,15),r.endFill(),r.x=i.width/o-t>>1,r.y=i.height/o-110,n.addChild(r),(a=this.slider).beginFill(15321380),a.drawRoundedRect(0,0,0,e,15),a.endFill(),a.x=i.width/o-t>>1,a.y=i.height/o-110,n.addChild(a),(c=this.label).x=i.width/o-c.width>>1,c.y=i.height/o-140,n.addChild(c),u=this.loader=this.status.$loader.getNewLoader(),this.loaderProgressId=u.onProgress.add(this.onProgress,this),this.loaderErrorId=u.onError.add(this.onError,this),u.onComplete.once(this.onLoadComplete,this),this.start(2e4),[2]}))}))},e.prototype.onError=function(t){this.sendError({code:"404",message:"loading.ts -> "+t.message,data:t})},e.prototype.onProgress=function(t){},e.prototype.tweenE=function(t){var e=this;this.slider.beginFill(15321380),this.slider.drawRoundedRect(0,0,20,this.h,15),this.slider.endFill();var o={w:0};this.tween.stop(),this.tween.setObject(o),this.tween.onUpdate=function(){e.slider.beginFill(15321380),e.slider.drawRoundedRect(10,0,Math.floor(o.w),e.h,20),e.slider.endFill(),e.label.text="loading... "+Math.floor(o.w/e.c)+"%"},this.tween.to({w:this.w-10},t).start()},e.prototype.onLoadComplete=function(){var t=this;this.loader.onProgress.detach(this.loaderProgressId),this.loader.onProgress.detach(this.loaderErrorId),this.loader=void 0,this.tween.gotoAndEnd(),setTimeout((function(){t.onComplete&&(t.onComplete(),t.onComplete=void 0)}),300)},e.prototype.addRes=function(t,e,o){return this.loader.add(t,e,o)},e.prototype.loadRes=function(){this.loader.load()},e.prototype.start=function(t){this.label.text="loading... 1%",this.tweenE(t)},e.prototype.release=function(){t.prototype.release.call(this),this.onComplete=void 0,this.tween.release(),this.slider.destroy(),this.sliderBG.destroy(),this.label.destroy()},e}(o(627).ClassRoomObject);e.Loading=a},852:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.setVideoBg=void 0,e.setVideoBg=function(t,e){var o=new vf.gui.Rect;o.color=16777215,o.lineWidth=0,o.width=320,o.height=240,o.radius=10,t.addChildAt(o,0);var i=new vf.gui.Image;i.src="T"===e?"//ic-static-ali.vipkid.com.cn/course/material/VF_trial_L1U7/static/img/avatar/teacher.png":"//ic-static-ali.vipkid.com.cn/course/material/VF_trial_L1U7/static/img/avatar/student.png",i.scaleX=i.scaleY=.2,i.anchorX=i.anchorY=.5,i.x=160,i.y=120,t.addChildAt(i,1)}},579:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.systemCheck=void 0;var i=o(627);e.systemCheck=function(t,e){t.camera=!0,t.microphone=!0,t.video=!0;var o=vf.utils.getSystemInfo(),n=o.os.name,r=o.browser;if(console.log(o),"iOS"===n)if("Safari"===r.name)switch(parseInt(r.version)){case 9:t.camera=!1,t.microphone=!1,t.video=!0,t.singleMovie=!0;break;case 10:e.app.view.style.top="0px",t.camera=!1,t.microphone=!1,t.video=!0,t.singleMovie=!0;break;default:t.microphone=!1}else t.camera=!1,t.microphone=!1;else"Android"===n&&(t.microphone=!1);-1!==o.ua.indexOf("MicroMessenger")&&(t.platform=i.Platform.WXH5,t.microphone=!0)}},951:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.Action=void 0;var r=o(627),s=o(100),a=function(t){function e(){var e=t.call(this)||this;return e.name="",e.interactiveAction=!1,e.waitingToCompleted=!0,e._state=s.ActionState.Initial,e.uid=vf.utils.uid(),e.status=void 0,e.controller=void 0,e.stage=void 0,e}return n(e,t),e.prototype.setStatus=function(t,e,o){this.stage=t,this.status=e,this.controller=o},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(){this._state=s.ActionState.Ready;var t=this.stage.container.parent;t.interactiveChildren!==this.interactiveAction&&(t.interactiveChildren=this.interactiveAction),this.onExecute(),vf.Ticker.shared.add(this.onupdate,this)},e.prototype.onExecute=function(){},e.prototype.onLoad=function(){},e.prototype.prepare=function(){this._state=s.ActionState.Loading,this.onPrepare()},e.prototype.onPrepare=function(){},e.prototype.doPrepareReady=function(){this._state=s.ActionState.Ready,this.emit(e.ActionReady,this)},e.prototype.finish=function(){this._state=s.ActionState.Disabled,this.stage.container.parent.interactiveChildren=!1,this.doFinish(!1)},e.prototype.cancel=function(){this._state!==s.ActionState.Disabled&&(this.onCancel(),this._state=s.ActionState.Disabled,this.doFinish(!0))},e.prototype.onCancel=function(){},e.prototype.doFinish=function(t){vf.Ticker.shared.remove(this.onupdate,this),this.emit(e.ActionCompleted,this,t),!t&&this.gotoStep&&this.controller.dispatch({code:r.EventList.acitonByGotoProcess,data:this,level:"command"}),this.faileds=void 0},e.prototype.previousAction=function(t){this.previousNode=t},e.prototype.onupdate=function(t){},e.prototype.onCompletedListener=function(t,o){this.on(e.ActionCompleted,t,o)},e.prototype.offCompletedListener=function(t,o){this.off(e.ActionCompleted,t,o)},e.ActionCompleted="ActionCompleted",e.ProcessCompleted="ProcessCompleted",e.ActionReady="ActionReady",e.ProcessReady="ProcessReady",e}(vf.utils.EventEmitter);e.Action=a},507:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.EventList=void 0;var o=function(){function t(){}return t.wsOpen="websocketOpen",t.wsMessage="websocketOpen",t.wsClose="websocketClose",t.wsError="websocketError",t.wsInitComplete="wsInitComplete",t.wsStepFinish="wsStepFinish",t.wsStepPreload="wsStepPreload",t.wsInteractStart="wsInteractStart",t.wsInteractStop="wsInteractStop",t.wsException="wsException",t.coursewarePageLoaded="coursewarePageLoaded",t.coursewareClickEvent="coursewareClickEvent",t.coursewareSoundEnd="coursewareSoundEnd",t.changePage="changePage",t.sendSignal="sendSignal",t.enterClassRoom="enterClassRoom",t.recorderReady="recorderReady",t.startRecord="startRecord",t.stopRecord="stopRecord",t.recordError="recordError",t.recordTimeOut="recordTimeOut",t.recordState="recordState",t.sendRecordResult="sendRecordResult",t.sendRecordFailDiff="sendRecordFailDiff",t.face="face",t.log="log",t.videoByPlay="videoByPlay",t.videoByMuted="videoByMuted",t.videoStart="videoStart",t.videoEnd="videoEnd",t.acitonByGotoProcess="acitonByGotoProcess",t.acitonByNextStep="acitonByNextStep",t.openCameraError="openCameraError",t}();e.EventList=o},100:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ActionState=void 0,function(t){t[t.Initial=0]="Initial",t[t.Loading=1]="Loading",t[t.Ready=2]="Ready",t[t.Locked=3]="Locked",t[t.Disabled=4]="Disabled"}(e.ActionState||(e.ActionState={}))},137:function(t,e){Object.defineProperty(e,"__esModule",{value:!0})},324:function(t,e){Object.defineProperty(e,"__esModule",{value:!0})},147:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.Process=void 0;var r=o(951),s=o(100),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.processName="",e.nodes=[],e.afterNodes=[],e.stopNodes=[],e}return n(e,t),e.prototype.add=function(t){this.nodes.push(t)},e.prototype.getNodeByIndex=function(t){return this.nodes[t]},e.prototype.remove=function(t){if("number"==typeof t&&this.stopNodes[t])return this.stopNodes.splice(t,1),!0;var e=this.stopNodes.indexOf(t);if(-1!==e)return this.stopNodes.splice(e,1),!0;if("number"==typeof t&&this.nodes[t])return this.nodes.splice(t,1),!0;var o=this.nodes.indexOf(t);return-1!==o&&(this.nodes.splice(o,1),!0)},e.prototype.removeAfter=function(t){var e=this.nodes.indexOf(t);return-1!==e&&(this.afterNodes.splice(e,1),!0)},e.prototype.afterByCurrent=function(t){var e=this.nodes.indexOf(t);return-1!==e&&(this.nodes.splice(e,1),-1===this.afterNodes.indexOf(t)&&this.afterNodes.push(t),!0)},e.prototype.clear=function(){var t=this;this.nodes.forEach((function(e){e.cancel(),e.offCompletedListener(t.nodeCompletedHandler,t)})),this.stopNodes.forEach((function(e){e.cancel(),e.offCompletedListener(t.nodeCompletedHandler,t)})),this.afterNodes.forEach((function(e){e.cancel(),e.offCompletedListener(t.nodeCompletedHandler,t)})),this.stopNodes=[],this.afterNodes=[],this.nodes=[]},Object.defineProperty(e.prototype,"count",{get:function(){return this.nodes.length||this.stopNodes.length},enumerable:!1,configurable:!0}),e.prototype.nodeCompletedHandler=function(t,e){this.completeNode(t,this),e?this.afterByCurrent(t):this.nodes.length>0?this.runAllAsyncNodes(t):this.completeProcess()},e.prototype.start=function(){for(;this.stopNodes.length>0;)this.nodes.push(this.stopNodes.shift());0==this.nodes.length?this.completeProcess():this.runAllAsyncNodes()},e.prototype.stop=function(){for(this.afterNodes.forEach((function(t){t.state===s.ActionState.Ready&&t.cancel()}));this.nodes.length>0;)this.afterNodes.push(this.nodes.shift());this.stopNodes=this.afterNodes.concat(),this.afterNodes=[],this.nodes=this.stopNodes.concat(),this.stopNodes=[]},e.prototype.executeNode=function(t,e){t.waitingToCompleted&&t.onCompletedListener(this.nodeCompletedHandler,this),this.afterNodes.push(t),this.nodes.shift(),e&&t.previousAction(e),t.execute()},e.prototype.runAllAsyncNodes=function(t){for(;this.nodes.length>0&&!this.nodes[0].waitingToCompleted;)this.executeNode(this.nodes[0]);this.nodes.length>0&&this.nodes[0].waitingToCompleted&&this.executeNode(this.nodes[0],t)},e.prototype.onCompletedListener=function(t,e){this.on(r.Action.ProcessCompleted,t,e)},e.prototype.offCompletedListener=function(t,e){this.off(r.Action.ProcessCompleted,t,e)},e.prototype.completeProcess=function(){this.emit(r.Action.ProcessCompleted,this)},e.prototype.completeNode=function(t,e){t.offCompletedListener(this.nodeCompletedHandler,e)},e}(vf.utils.EventEmitter);e.Process=a},760:function(t,e){var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseObject=void 0;var s=function(t){function e(){var e=t.call(this)||this;return e.status=void 0,e.controller=void 0,e}return i(e,t),e.prototype.setStatus=function(t,e,o){this.$stage=t,this.status=e,this.controller=o},e.prototype.onLoad=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2]}))}))},e.prototype.sendMessage=function(t){t.level="command",this.controller.dispatch(t)},e.prototype.sendError=function(t){t.level="error",this.controller.dispatch(t)},e.prototype.release=function(){t.prototype.release.call(this)},e}(vf.gui.DisplayObject);e.BaseObject=s},40:function(t,e){var o=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ClassRoomObject=void 0;var n=function(){function t(){this.status=void 0,this.controller=void 0,this.stage=void 0}return t.prototype.setStatus=function(t,e,o){this.stage=t,this.status=e,this.controller=o},t.prototype.onLoad=function(){return o(this,void 0,void 0,(function(){return i(this,(function(t){return[2]}))}))},t.prototype.sendMessage=function(t){t.level="command",this.controller.dispatch(t)},t.prototype.sendError=function(t){t.level="error",this.controller.dispatch(t)},t.prototype.release=function(){},t.prototype.releaseAll=function(){this.release()},t}();e.ClassRoomObject=n},806:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Controller=void 0;var o=function(){function t(t){this.stage=t,this.eventEmit=new vf.utils.EventEmitter,this.load()}return t.prototype.load=function(){this.stage.on("onMessage",this.onMessage,this)},t.prototype.release=function(){this.stage.off("onMessage",this.onMessage,this),this.eventEmit.removeAllListeners()},t.prototype.sendServer=function(t,e){this.ws&&this.ws.sendData(t,e)},t.prototype.subscribe=function(t,e,o,i){i?this.eventEmit.once(t,e,o):this.eventEmit.on(t,e,o)},t.prototype.unSubscribe=function(t,e,o){return this.eventEmit.off(t,e,o),this},t.prototype.dispatch=function(t){switch(t.level){case"command":return this.eventEmit.emit(t.code,t);case"error":case"warning":case"info":return this.stage.emit("status",t)}return!1},t.prototype.onMessage=function(t){switch(t.code){case"a":t.message="xxxxx";break;case"b":t.data={action:"xxxxx"}}this.eventEmit.emit(t.code,t)},t}();e.Controller=o},627:function(t,e,o){var i=this&&this.__createBinding||(Object.create?function(t,e,o,i){void 0===i&&(i=o),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[o]}})}:function(t,e,o,i){void 0===i&&(i=o),t[i]=e[o]}),n=this&&this.__exportStar||function(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||i(e,t,o)};Object.defineProperty(e,"__esModule",{value:!0}),e.getClassRoomObject=void 0,n(o(59),e),n(o(760),e),n(o(137),e),n(o(806),e),n(o(508),e),n(o(40),e),n(o(507),e),n(o(100),e),n(o(951),e),n(o(324),e),n(o(147),e),e.getClassRoomObject=function(t,e){var o=t;return o.setStatus(e.stage,e.status,e.controller),o.onLoad(),o}},556:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Loaders=void 0;var o=function(){function t(){this.res={}}return t.prototype.getNewLoader=function(){var t=new vf.Loader;return t.onComplete.once(this.onComplete,this),t},t.prototype.onComplete=function(t){for(var e in t.resources)this.res[e]||(this.res[e]=t.resources[e]);t.reset()},t}();e.Loaders=o},508:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.Status=e.Platform=e.FACESTATUS=void 0;var i,n,r=o(556);!function(t){t[t.NOFACE=0]="NOFACE",t[t.FACEBACK=1]="FACEBACK"}(i=e.FACESTATUS||(e.FACESTATUS={})),function(t){t[t.H5=0]="H5",t[t.WXH5=1]="WXH5"}(n=e.Platform||(e.Platform={}));var s=function(){function t(){this.ee=new vf.utils.EventEmitter,this.topOffset=0,this.$loader=new r.Loaders,this.platform=n.H5,this.wss="wss://ai-wss.vipkid.com.cn/acs/api/v1",this._appId="f793db34561c11ebb7f947a3ed5af0b7",this._userId="13200000000",this._classId="1",this._roomId="123344",this.changePageTime=0,this._currentPage=-1,this._syncId=1,this._stepId=0,this._totalPage=0,this._isHaveFace=i.NOFACE,this._role=2,this._video=!0,this._camera=!0,this._microphone=!0,this._singleMovie=!1,this._pageDatas=[],this.completeMessage="完课提示"}return t.prototype.on=function(t,e,o){return this.ee.on(t,e,o),this},t.prototype.off=function(t,e,o){return this.ee.off(t,e,o),this},Object.defineProperty(t.prototype,"res",{get:function(){return this.$loader.res},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"debugOption",{get:function(){var t=window.getQueryVariable;return void 0===t?{}:{page:parseInt(t("page")),roomId:t("roomId"),jsonpath:t("jsonpath")}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appId",{get:function(){return this._appId},set:function(t){var e=this._appId;this._appId=t,this.ee.emit("appId",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},set:function(t){var e=this._userId;this._userId=t,this.ee.emit("userId",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classId",{get:function(){return this._classId},set:function(t){var e=this._classId;this._classId=t,this.ee.emit("classId",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roomId",{get:function(){return this._roomId},set:function(t){var e=this._roomId;this._roomId=t,this.ee.emit("roomId",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return-1===this._currentPage?this.debugOption.page||0:parseInt(this._currentPage)},set:function(t){this.changePageTime=performance.now(),this.syncId=1;var e=this._currentPage;this._currentPage=parseInt(t),this.ee.emit("currentPage",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"syncId",{get:function(){return this._syncId++},set:function(t){this._syncId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stepId",{get:function(){return this._stepId},set:function(t){var e=this._stepId;this._stepId=t,this.ee.emit("stepId",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalPage",{get:function(){return this._totalPage},set:function(t){var e=this._totalPage;this._totalPage=t,this.ee.emit("totalPage",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHaveFace",{get:function(){return this._isHaveFace},set:function(t){var e=this._role;this._isHaveFace=t,this.ee.emit("isHaveFace",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"role",{get:function(){return this._role},set:function(t){var e=this._role;this._role=t,this.ee.emit("role",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"video",{get:function(){return this._video},set:function(t){var e=this._video;this._video=t,this.ee.emit("video",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"camera",{get:function(){return this._camera},set:function(t){var e=this._camera;this._camera=t,this.ee.emit("camera",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"microphone",{get:function(){return this._microphone},set:function(t){var e=this._microphone;this._microphone=t,this.ee.emit("micInfo",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"singleMovie",{get:function(){return this._singleMovie},set:function(t){this._singleMovie=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"myotee",{get:function(){return this._myotee},set:function(t){var e=this._myotee;this._myotee=t,this.ee.emit("myotee",t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageDatas",{get:function(){return this._pageDatas},set:function(t){var e=this._pageDatas;this._pageDatas=t,this.ee.emit("pageDatas",t,e)},enumerable:!1,configurable:!0}),t}();e.Status=s},59:function(t,e,o){var i=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.TestBase=void 0;var r=o(806),s=o(508),a=function(){function t(t,e){this.uiStage=e,this.app=t,this.status=new s.Status,this.controller=new r.Controller(e)}return t.prototype.load=function(){return i(this,void 0,void 0,(function(){var t,e;return n(this,(function(o){switch(o.label){case 0:return[4,vf.utils.readFileSync("./config.json",{responseType:"json"})];case 1:return t=o.sent(),[4,vf.utils.readFileSync("./dist/"+t.buildPackageName[0]+".js",{moduleName:t.buildPackageName[0]})];case 2:return e=o.sent(),this.onLoad(e),this.addReleaseButton(),this.addSystemMsgButton(),[2]}}))}))},t.prototype.onLoad=function(t){return i(this,void 0,void 0,(function(){return n(this,(function(t){return[2,void 0]}))}))},t.prototype.getNewButton=function(t,e){var o=new vf.gui.Button;return o.up="./assets/button/button_up.png",o.down="./assets/button/button_down.png",o.move="./assets/button/button_move.png",o.useMoveEvent=!0,o.width=200,o.height=55,o.text=t,e&&e.addChild(o),o},t.prototype.addReleaseButton=function(){var t=this,e=this.getNewButton("卸载测试");return e.style.right=0,e.style.bottom=0,this.uiStage.addChild(e),e.once("click",(function(){t.uiStage.uiChildren.forEach((function(t){t.releaseAll()}))})),e},t.prototype.addSystemMsgButton=function(){var t=this,e=new vf.gui.Button;return e.up="./assets/button/button_up.png",e.down="./assets/button/button_down.png",e.move="./assets/button/button_move.png",e.useMoveEvent=!0,e.width=200,e.height=55,e.style.right=220,e.style.bottom=0,e.text="发送外部全局事件",this.uiStage.addChild(e),e.on("click",(function(){t.uiStage.emit("onMessage",{code:"test-system",message:"测试数据",level:"command"})})),e},t}();e.TestBase=a},785:function(t,e){Object.defineProperty(e,"__esModule",{value:!0})},530:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__createBinding||(Object.create?function(t,e,o,i){void 0===i&&(i=o),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[o]}})}:function(t,e,o,i){void 0===i&&(i=o),t[i]=e[o]}),s=this&&this.__exportStar||function(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||r(e,t,o)},a=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},c=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Courseware=e.setVideoRectMask=void 0;var u=o(627),l=o(23);function h(t,e,o,i,n,r){if(void 0===o&&(o=320),void 0===i&&(i=240),void 0===n&&(n=0),void 0===r&&(r=0),"rect"===e){if(t.style.maskImage&&t.style.maskImage instanceof vf.gui.Rect)return t.style.maskImage.x=n,t.style.maskImage.x=r,void(t.style.maskSize=[o,i]);var s=new vf.gui.Rect;s.color=16777215,s.lineColor=16711884,s.lineWidth=1,s.radius=10,s.width=o,s.height=i,s.x=n,s.y=r,t.style.maskImage=void 0,t.style.maskImage=s}else{if(t.style.maskImage&&t.style.maskImage instanceof vf.gui.Circle)return void(t.style.maskSize=[o,i]);var a=new vf.gui.Circle;a.width=o,a.height=i,a.color=16777215,a.lineColor=16711884,a.lineWidth=1,t.addChild(a),t.style.maskImage=a}}s(o(785),e),e.setVideoRectMask=h;var d=function(t){function e(){var e=t.call(this)||this;return e.signalList={},e._msgList=[],e._ready=!1,e}return n(e,t),e.prototype.onLoad=function(){return a(this,void 0,void 0,(function(){return c(this,(function(t){return this.controller.subscribe(u.EventList.changePage,this.onChangePage,this),this.controller.subscribe(u.EventList.sendSignal,this.onSendSignal,this),[2]}))}))},e.prototype.loadJson=function(){var t=document.createElement("a"),e=new Blob([JSON.stringify(this.signalList)]);t.download="signal.json",t.href=URL.createObjectURL(e),t.click(),URL.revokeObjectURL(e)},e.prototype.init=function(t,e,o,i){return a(this,void 0,void 0,(function(){var t=this;return c(this,(function(n){return[2,new Promise((function(n){t.once("ready",(function(){n(!0)})),t._ready=!1,t._msgList=[],t.student=o,t.teacher=i;var r=window.vfCourseWare.default;(t.curseware=new r(e,{role:t.status.role,ratio:1,envCode:"test"})).onMessage=t.onMessage.bind(t),t.setHistoryPage(t.status.currentPage)}))]}))}))},e.prototype.setHistoryPage=function(t){var e={code:"history",type:"history",data:{historyObj:{changePage:{page:t}}}};this.sendMessageCourseware(e)},e.prototype.setLivePage=function(t){var e={name:"changePage",data:{name:"changePage",val:{page:t}}};this.sendMessageCourseware(e)},e.prototype.sendMessageCourseware=function(t){console.log("vf - 课堂发送消息到课件:",t),this._ready?(t.type="live",this.curseware.receiveMessage(t)):this._msgList.push(t)},e.prototype.restore=function(){this._ready?this.curseware.restore():console.warn("vf - restore -> 课件不存在")},e.prototype.onSendSignal=function(t){var e=this;t.data.signalList.forEach((function(t){var o={};o.data=t,e.sendMessageCourseware(o)}))},e.prototype.onChangePage=function(t){var e=t.data.page;this.setLivePage(e)},e.prototype.onMessage=function(t){var e,o,i,n;if("ready"===t.code)for(this._ready=!0;this._msgList.length>0;)this.curseware.receiveMessage(this._msgList.shift());if(this._ready){if(console.log("vf - 课件发送消息到课堂",t),void 0===t.level&&(t.level="command"),"portrait"===t.code)return void this.onCoursewarePortrait(t);if("local_audio_end"===t.code)return void this.controller.dispatch({code:u.EventList.coursewareSoundEnd,data:t.srcList,level:"command"});if(-1!==t.code.indexOf("syncInteraction")){var r=t.opdata.signal;return void("S"===r.val.role&&-1!==r.val.data.indexOf("path")&&this.controller.dispatch({code:u.EventList.coursewareClickEvent,data:r.val.data,level:"command",message:"学生点击操作"}))}if("VF_LOG:LOADED"===(null===(n=null===(i=null===(o=null===(e=t)||void 0===e?void 0:e.opdata)||void 0===o?void 0:o.emit)||void 0===i?void 0:i.data)||void 0===n?void 0:n.event_id))return void this.emit(u.EventList.coursewarePageLoaded,this);t.code&&this.emit(t.code),this.controller.dispatch(t)}},e.prototype.onCoursewarePortrait=function(t){var e=this;if(void 0!==this.stage){var o=t.opdata.emit.data.role,i=[this.student,this.teacher];o.forEach((function(o,n){var r=i[n];r&&e.stage&&(r.x=o.left,r.y=o.top-e.status.topOffset,1===n?(r instanceof l.MovieClip?"rect"!==o.shape?r.setVideoPos(-90,-70):r.setVideoPos(0,0):"rect"!==o.shape?(r.video.x=-90,r.video.y=-70):(r.video.x=0,r.video.y=0),r.width=o.width,r.height=o.height):(r.width=320*o.height/240,r.height=o.height),r.visible="show"===t.opdata.emit.data.type,h(r,o.shape,o.width-4,o.height-4,2,1))})),"mobile"===vf.utils.getSystemInfo().device.type&&(i[1].scaleX=i[1].scaleY=.7,i[0].scaleX=i[0].scaleY=.7,i[0].y+=30,i[1].y+=30,i[1].x=.7*i[0].x-50)}},e.prototype.release=function(){t.prototype.release.call(this),this.offAll(),this.controller.unSubscribe(u.EventList.changePage,this.onChangePage,this),this.controller.unSubscribe(u.EventList.sendSignal,this.onSendSignal,this),this.curseware&&(this.curseware.releaseAll(),this.curseware.onMessage=void 0)},e}(u.BaseObject);e.Courseware=d},961:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.EnterButton=void 0;var a=o(627),c=function(t){function e(){var e=t.call(this)||this;return e.video=new vf.gui.Video,e.button=void 0,e}return n(e,t),e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){return s(this,(function(t){this.addButton(),this.video.width=10,this.video.height=10,this.video.src=this.status.res.video,this.video.visible=!1;try{this.sound=vf.AudioEngine.Ins().createAudio("sound",this.status.res.sound.data)}catch(t){console.log(t)}return this.status.video&&this.addChild(this.video),[2]}))}))},e.prototype.addButton=function(){if(void 0!==this.stage){var t=this.button=new vf.gui.Button;t.label.resolution=window.devicePixelRatio||1,t.useMoveEvent=!0,t.up="assets/button/button.png",t.down="assets/button/button-click.png",t.move="assets/button/button-click.png",t.text="进入教室",t.width=250,t.height=60,t.x=this.stage.width/2-125,t.y=this.stage.height-150,t.once("click",this.clickButtonEvent,this),this.addChild(this.button)}},e.prototype.clickButtonEvent=function(){var t,e=this;void 0!==this.stage&&(0!==this.status.pageDatas.length?(this.button.visible=!1,this.alertGui||(this.alertGui=vf.gui.Alert.show(this.stage,"进入教室中，请稍后...")),this.video.load(),this.video.play(),this.sound&&this.sound.play(),setTimeout((function(){var t;e.video.pause(),e.sound&&e.sound.stop(),null===(t=e.alertGui)||void 0===t||t.release(),e.emit(a.EventList.enterClassRoom)}),100)):this.alertGui||(this.alertGui=vf.gui.Alert.show(this.stage,this.status.completeMessage,void 0,9999999),null===(t=this.controller.ws)||void 0===t||t.release()))},e.prototype.release=function(){var e;t.prototype.release.call(this),this.offAll(),this.video.release(),this.sound&&this.sound.stop(),this.button.release(),null===(e=this.alertGui)||void 0===e||e.release(),document.body.className="",document.body.style.backgroundColor="#192375"},e}(a.BaseObject);e.EnterButton=c},23:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.MovieClip=void 0;var a,c,u=o(627),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curVideoIdx=1,e.playCnt=0,e.urlList=[],e.loadIntervalWaiting=!1,e.toPlayAfterWait=!1,e._muted=!1,e.firstPlay=!1,e}return n(e,t),e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){var t=this;return s(this,(function(e){return this.vs1=new d(this,330,250,1),this.vs2=new d(this,330,250,2),this.vs1.callback=function(e){return t.onVSCallback(e,t.vs1,t.vs2)},this.vs2.callback=function(e){return t.onVSCallback(e,t.vs2,t.vs1)},this.controller.subscribe(u.EventList.videoByPlay,this.playByEvent,this),this.controller.subscribe(u.EventList.videoByMuted,this.muteByEvent,this),[2]}))}))},e.prototype.onVSCallback=function(t,e,o){if(t===c.start)e.open(this._muted),o.close(),this.onVideoStart(e.url);else if(t===c.end){var i=this.playCnt;this.onVideoEnd(e.url),i===this.playCnt&&this.playNext()}},e.prototype.release=function(){t.prototype.release.call(this),this.controller.unSubscribe(u.EventList.videoByPlay,this.playByEvent,this),this.controller.unSubscribe(u.EventList.videoByMuted,this.muteByEvent,this),this.vs1.release(),this.vs2.release()},e.prototype.setDefaultUrl=function(t){console.log("MovieClip default: ",t),this.defaultUrl=t},e.prototype.play=function(t){console.log("MovieClip play: ",t),this.loadingUrl=void 0,t?this.urlList=t instanceof Array?t:[t]:this.urlList.length=0,this.playNext()},Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted!==t&&(console.log("MovieClip muted: ",t),this._muted=t,this.getCurVideoStruc().video.muted=t)},enumerable:!1,configurable:!0}),e.prototype.setVideoPos=function(t,e){this.vs1.video.x=t,this.vs1.video.y=e,this.vs2.video.x=t,this.vs2.video.y=e},e.prototype.switchVideo=function(){1===this.curVideoIdx?this.curVideoIdx=2:this.curVideoIdx=1},e.prototype.getCurVideoStruc=function(){return 1===this.curVideoIdx?this.vs1:this.vs2},e.prototype.getSubVideoStruc=function(){return 1===this.curVideoIdx?this.vs2:this.vs1},e.prototype.playNext=function(){var t=this;if(this.playCnt++,this.loadIntervalWaiting)this.toPlayAfterWait=!0;else if(this.curUrl=this.loadingUrl,this.loadingUrl=0===this.urlList.length?this.defaultUrl:this.urlList.shift(),this.curUrl){var e=this.getCurVideoStruc();if((this.curUrl!==e.url||e.playing)&&(this.switchVideo(),e=this.getCurVideoStruc()),!this.firstPlay){this.firstPlay=!0;var o=this.getVideoArraybuffer(this.curUrl);e.video.src=o,setTimeout((function(){e.playing=!0,e.video.play(),e.callback&&e.callback(c.start)}),20);var i=this.getSubVideoStruc();return i.video.src=o,void setTimeout((function(){i.video.play()}),20)}e.play(this.curUrl);var n=this.getSubVideoStruc();if(this.loadingUrl&&this.loadingUrl!==e.url&&this.loadingUrl!==n.url){this.loadIntervalWaiting=!0;var r=this.loadingUrl;setTimeout((function(){t.loadIntervalWaiting=!1,n.preload(r),t.toPlayAfterWait&&(t.toPlayAfterWait=!1,t.playNext())}),300)}}else this.loadingUrl?this.playNext():this.onVideoAllEnd()},e.prototype.playByEvent=function(t){var e=t.data.urls;this.play(e)},e.prototype.muteByEvent=function(t){var e=t.data.muted;this.muted=e},e.prototype.onVideoStart=function(t){this.sendMessage({code:u.EventList.videoStart,data:{clip:this,url:t}})},e.prototype.onVideoEnd=function(t){this.sendMessage({code:u.EventList.videoEnd,data:{clip:this,url:t}})},e.prototype.onVideoAllEnd=function(){console.log("MovieClip video all end!")},e.prototype.getVideoArraybuffer=function(t){var e=this.status.res[t];if(e){var o=new Uint8Array(e.data);return window.URL.createObjectURL(new Blob([o],{type:"video/mp4"}))}return t},e}(u.BaseObject);function h(t){return t.slice(t.lastIndexOf("/"))}e.MovieClip=l,function(t){t[t.none=0]="none",t[t.loading=1]="loading",t[t.canplay=2]="canplay"}(a||(a={})),function(t){t[t.canplay=1]="canplay",t[t.start=2]="start",t[t.end=3]="end"}(c||(c={}));var d=function(){function t(t,e,o,i){var n=this;this.video=new vf.gui.Video,this.url="",this.realUrl="",this.state=a.none,this.autoPlay=!1,this.playing=!1,this.id=1,this.video.width=e,this.video.height=o,this.id=i,this.video.videoElement.controls=!1;var r=this.video.videoElement;r.crossOrigin="anonymous",r.volume=1,r.addEventListener("canplay",(function(){h(r.src)===h(n.realUrl)&&(n.callback&&n.callback(c.canplay),n.autoPlay?(n.state=a.none,n.playVideo()):n.state=a.canplay,n.autoPlay=!1)})),r.addEventListener("ended",(function(){n.playing&&(n.playing=!1,n.callback&&n.callback(c.end))})),r.addEventListener("error",(function(){console.error("MovieClip! video error: ",n.id,r.src,r.error)})),this.mc=t,t.status.video&&t.addChild(this.video),this.close()}return t.prototype.release=function(){this.video.release()},t.prototype.play=function(t){t!==this.url?this.loadVideo(t,!0):this.state===a.canplay?(this.state=a.none,this.playVideo()):this.state===a.loading?this.autoPlay=!0:this.playVideo()},t.prototype.preload=function(t){this.loadVideo(t,!1)},t.prototype.open=function(t){this.video.visible=!0,this.video.muted=t},t.prototype.close=function(){this.video.visible=!1,this.video.muted=!0,this.playing=!1,this.video.pause()},t.prototype.loadVideo=function(t,e){this.state=a.loading,this.autoPlay=e,this.url=t,this.realUrl=this.mc.getVideoArraybuffer(t),this.video.src=this.realUrl},t.prototype.playVideo=function(){this.playing=!0,this.video.currentTime=0,this.video.play(),this.callback&&this.callback(c.start)},t}()},249:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.MovieClipSingle=void 0;var a=o(627),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playingUrl="",e.defaultUrl="",e.aaa=0,e}return n(e,t),e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){return s(this,(function(t){return this.video||(this.video=new vf.gui.Video,this.endMovieFun=this.endMovie.bind(this),this.video.on("ended",this.endMovieFun),this.video.width=330,this.video.height=250,this.addChild(this.video)),this.controller.subscribe(a.EventList.videoByPlay,this.playByEvent,this),this.controller.subscribe(a.EventList.videoByMuted,this.muteByEvent,this),[2]}))}))},e.prototype.setDefaultUrl=function(t){this.defaultUrl=t},e.prototype.playByEvent=function(t){var e=t.data.urls;this.play(e)},e.prototype.play=function(t){if(this.video){this.playingUrl=t;var e=this.getVideoArraybuffer(this.playingUrl);this.video.src=e,this.video.autoplay=!0,this.onVideoStart(this.playingUrl),this.video.play()}},e.prototype.onVideoStart=function(t){this.sendMessage({code:a.EventList.videoStart,data:{clip:this,url:Array.isArray(t)?t[0]:t}})},e.prototype.onVideoEnd=function(t){this.sendMessage({code:a.EventList.videoEnd,data:{clip:this,url:Array.isArray(t)?t[0]:t}})},e.prototype.endMovie=function(){this.onVideoEnd(this.playingUrl)},e.prototype.getVideoArraybuffer=function(t){var e=this.status.res[t];if(e){var o=new Uint8Array(e.data);return window.URL.createObjectURL(new Blob([o],{type:"video/mp4"}))}return t},e.prototype.muteByEvent=function(t){if(this.video){var e=t.data.muted;this.video.muted=e}},e.prototype.release=function(){this.controller.unSubscribe(a.EventList.videoByPlay,this.playByEvent,this),this.controller.unSubscribe(a.EventList.videoByMuted,this.muteByEvent,this),this.video&&(this.video.off("ended",this.endMovieFun),this.video.release(),this.video=void 0),t.prototype.release.call(this)},e}(a.BaseObject);e.MovieClipSingle=c},752:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.NetFlatBuffers=void 0;var a=o(627),c=o(767),u=function(t){function e(){var e=t.call(this)||this;return e.msgList=[],e.reconnectId=-1,e._onopen=e.onOpen.bind(e),e._onerror=e.onError.bind(e),e._onclose=e.onClose.bind(e),e._onmessage=e.onMessage.bind(e),e.builder=new flatbuffers.Builder(1),e}return n(e,t),Object.defineProperty(e.prototype,"connected",{get:function(){return void 0!==this.ws&&1===this.ws.readyState},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){var t;return s(this,(function(e){return"WebSocket"in window?(this.removeWS(),(t=this.ws=new WebSocket(this.status.wss)).addEventListener("open",this._onopen),t.addEventListener("error",this._onerror),t.addEventListener("message",this._onmessage),t.addEventListener("close",this._onclose),[2]):(this.sendError({code:a.EventList.wsError,message:"WebSocket NOT supported by your Browser!"}),[2])}))}))},e.prototype.onOpen=function(){for(this.sendMessage({code:a.EventList.wsOpen});this.msgList.length>0;){var t=this.msgList.shift();this.sendData(null==t?void 0:t.header,null==t?void 0:t.body)}this.guiAlert&&this.guiAlert.close()},e.prototype.onClose=function(t){switch(t.code){case 1e3:this.sendMessage({code:a.EventList.wsClose});break;default:this.guiAlert||(this.guiAlert=vf.gui.Alert.show(this.stage,"网络异常，尝试重连中("+t.code+")",void 0,105e3)),this.reconnect()}},e.prototype.onMessage=function(t){c.messageParse(t.data,this)},e.prototype.onError=function(t){this.sendError({code:a.EventList.wsError,message:"WebSocket Connection failed "+this.status.wss,data:t})},e.prototype.sendData=function(t,e){void 0===e&&(e={});var o=this.ws,i=this.builder;if(void 0===t.appId&&(t.appId=this.status.appId),void 0===t.magicNumber&&(t.magicNumber=this.status.userId+"|"+Math.random()),void 0===e.classId&&(e.classId=this.status.classId),void 0===e.roomId&&(e.roomId=this.status.roomId),void 0===e.userId&&(e.userId=this.status.userId),void 0===o||1!==o.readyState)return this.msgList.push({header:t,body:e}),void this.reconnect();var n,r,s=[];for(var a in t)n=i.createString(a),r=i.createString(t[a]),com.vipkid.iscp.websocket.message.tcp.TcpHeader.startTcpHeader(i),com.vipkid.iscp.websocket.message.tcp.TcpHeader.addKey(i,n),com.vipkid.iscp.websocket.message.tcp.TcpHeader.addValue(i,r),s.push(com.vipkid.iscp.websocket.message.tcp.TcpHeader.endTcpHeader(i));var c=com.vipkid.iscp.websocket.message.tcp.TcpPackage.createHeaderVector(i,s),u=new Uint8Array(this.str2ab(JSON.stringify(e))),l=com.vipkid.iscp.websocket.message.tcp.TcpPackage.createBodyVector(i,u);com.vipkid.iscp.websocket.message.tcp.TcpPackage.startTcpPackage(i),com.vipkid.iscp.websocket.message.tcp.TcpPackage.addHeader(i,c),com.vipkid.iscp.websocket.message.tcp.TcpPackage.addBody(i,l);var h=com.vipkid.iscp.websocket.message.tcp.TcpPackage.endTcpPackage(i);i.finish(h),o.send(i.asUint8Array())},e.prototype.reconnect=function(){this.ws&&3===this.ws.readyState&&(clearTimeout(this.reconnectId),this.guiAlert||(this.guiAlert=vf.gui.Alert.show(this.stage,"网络异常，重试中...",void 0,105e3)),this.reconnectId=window.setTimeout(this.onLoad.bind(this),3e3))},e.prototype.str2ab=function(t){for(var e=new ArrayBuffer(t.length),o=new Uint8Array(e),i=0,n=t.length;i<n;i++)o[i]=t.charCodeAt(i);return e},e.prototype.removeWS=function(){if(this.ws){this.ws.close();var t=this.ws;t.removeEventListener("open",this._onopen),t.removeEventListener("error",this._onerror),t.removeEventListener("message",this._onmessage),t.removeEventListener("close",this._onmessage),this.ws=void 0}},e.prototype.release=function(){t.prototype.release.call(this),this.removeWS(),this.guiAlert&&this.guiAlert.release()},e}(a.ClassRoomObject);e.NetFlatBuffers=u},767:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.messageParse=void 0;var i=o(627),n={};function r(t,e,o,n){n.sendError({code:i.EventList.wsError,message:t,data:{header:e,body:o}})}function s(t,e){for(var o,i={},s=new flatbuffers.ByteBuffer(new Uint8Array(t)),a=com.vipkid.iscp.websocket.message.tcp.TcpPackage.getRootAsTcpPackage(s),c=0;c<a.headerLength();c++){var u=a.header(c);i[u.key()]=u.value()}var l=new flatbuffers.ByteBuffer(new Uint8Array(a.bodyArray())),h=com.vipkid.iscp.websocket.message.tcp.TcpRespBody.getRootAsTcpRespBody(l),d=h.code();if("10000"===d){var p=h.data();"{}"!==p&&(o=JSON.parse(p)),i.method&&n[i.method]?n[i.method](i,o,e):r("The header information does not exist",i,o,e)}else"10001"===d?(n[i.method](i,void 0,e),e.status.completeMessage=h.message()):r("server cdoe "+d+" "+h.message(),i,o,e)}n.init=function(t,e,o){if(e){var n=o.status;n.currentPage=n.debugOption.page||parseInt(e.pageId),n.stepId=parseInt(e.stepId),n.totalPage=parseInt(e.totalPage),e.pageList.forEach((function(t){n.pageDatas[t.index]=t}))}o.sendMessage({code:i.EventList.wsInitComplete,data:{header:t,body:e}})},n.step=function(t,e,o){switch(t.level){case"finish":o.sendMessage({code:i.EventList.wsStepFinish,data:{header:t,body:e}});break;case"preload":o.sendMessage({code:i.EventList.wsStepPreload,data:{header:t,body:e}});break;default:r("The header step does not exist",t,e,o)}},n.interactStart=function(t,e,o){o.sendMessage({code:i.EventList.wsInteractStart,data:{header:t,body:e}})},n.interactStop=function(t,e,o){o.sendMessage({code:i.EventList.wsInteractStop,data:{header:t,body:e}})},n.exception=function(t,e,o){o.sendMessage({code:i.EventList.wsException,data:{header:t,body:e}})},e.messageParse=function(t,e){if("string"==typeof t)e.sendMessage({code:i.EventList.wsMessage,data:JSON.parse(t)});else{if(void 0===t.arrayBuffer)return void function(t,e){var o=new FileReader;o.onload=function(t){var o;s(null===(o=t.target)||void 0===o?void 0:o.result,e)},o.readAsArrayBuffer(t)}(t,e);t.arrayBuffer().then((function(t){s(t,e)}))}}},390:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Recorder=e.NOTICE=e.RecorderStates=void 0;var a,c,u=o(627),l={appId:"122d3aff96a000b5fd5062ce5b483ca1",env:"prod",userId:"no_id"};!function(t){t[t.NOT_READY=1]="NOT_READY",t[t.CONNECTING=2]="CONNECTING",t[t.PREPARE_START=3]="PREPARE_START",t[t.AUDIO_RECORDING=4]="AUDIO_RECORDING",t[t.RESULT_RECEIVING=5]="RESULT_RECEIVING",t[t.RESULT_RECEIVED=6]="RESULT_RECEIVED",t[t.CLOSED=7]="CLOSED",t[t.INTERRUPTED=8]="INTERRUPTED"}(a||(a={})),e.RecorderStates=a,function(t){t.sdkException="录音测评运行异常，已自动恢复",t.noSupportRecord="当前环境不支持录音功能",t.networkException="录音测评网络异常，请稍后重试",t.recordTimeout="录音测评超时，请尝试重新录制",t.recordFailed="录音失败，请稍后重试"}(c=e.NOTICE||(e.NOTICE={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ready=!1,e.frame="",e}return n(e,t),e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){return s(this,(function(t){if(this.status.platform===u.Platform.H5)console.log("vf -> H5评测"),this.evaluater=new window.VKEvaluater({appId:l.appId,env:l.env,sdkType:"h5",userId:l.userId,onState:this.stateHandler.bind(this),onError:this.errorHandler.bind(this)});else{if(this.status.platform!==u.Platform.WXH5)throw new Error("位置的平台类型:"+this.status.platform);console.log("vf -> 微信公众号评测");try{this.evaluater=new window.VKEvaluater.default({debug:!0,appId:l.appId,env:l.env,type:"wx",userId:l.userId,selfWX:window.wx,onState:this.stateHandler.bind(this),onError:this.errorHandler.bind(this)}).core}catch(t){console.log(t)}}return this.controller.subscribe(u.EventList.startRecord,this.onStartRecord,this),this.controller.subscribe(u.EventList.stopRecord,this.stop,this),[2]}))}))},e.prototype.release=function(){t.prototype.release.call(this),this.controller.unSubscribe(u.EventList.startRecord,this.onStartRecord,this),this.controller.unSubscribe(u.EventList.stopRecord,this.stop,this),this.evaluater.close()},Object.defineProperty(e,"Ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),e.prototype.setWXH5RecordConfig=function(t){return t=t.data,window.wx.config({debug:!0,appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","translateVoice"]}),window.wx.error((function(t){console.log(t)})),new Promise((function(t){window.wx.ready((function(){return l.appId="364a23a564b21c1fe5ecda6e48a3984c",l.userId="yangxiao",l.env="test",console.clear(),console.log(l),t(l)}))}))},e.prototype.init=function(t){var e=this;return new Promise((function(o){t.controller.subscribe(u.EventList.recorderReady,(function(){e.evaluater.core&&e.evaluater.core.recorder&&(e.status.audioInput=e.evaluater.core.recorder.recorderCore.audioInput),o(e)}),void 0,!0),t.controller.subscribe(u.EventList.recordError,(function(){o(void 0)}),void 0,!0),u.getClassRoomObject(e,t)}))},e.prototype.getReady=function(){return this.ready},e.prototype.onStartRecord=function(t){this.frame=t.data.frame;var e=t.data.record;this.start(e.recordText,e.keyWords)},e.prototype.start=function(t,e){if(this.status.platform!==u.Platform.H5||this.ready)try{this.evaluater.start({refText:t,keyWords:e,textMode:0,evalMode:3,rank:100,receiveTimeout:15e3})}catch(t){console.log("录音错误error",t),this.errorHandler(t)}else console.log("录音没有准备好")},e.prototype.stop=function(){if(this.status.platform!==u.Platform.H5||this.ready)try{console.log("语音停止"),this.evaluater.stop()}catch(t){this.errorHandler(t)}},e.prototype.cancel=function(){if(this.ready)try{this.evaluater.cancel()}catch(t){this.errorHandler(t)}},e.prototype.setFrame=function(t){this.frame=t},e.prototype.stateHandler=function(t){switch(console.log("录音state-",t.code,t),t.code){case a.NOT_READY:case a.CONNECTING:break;case a.PREPARE_START:this.ready=!0,this.recorderReadyCallback();break;case a.AUDIO_RECORDING:this.evaluater.core&&this.evaluater.core.recorder&&(this.status.audioInput=this.evaluater.core.recorder.recorderCore.audioInput),this.sendMessage({code:u.EventList.recordState,data:a.AUDIO_RECORDING}),this.startRecordCallback();break;case a.RESULT_RECEIVING:break;case a.RESULT_RECEIVED:this.ready=!1;var e=t.data;e&&this.finishRecordCallback(e);break;case a.CLOSED:case a.INTERRUPTED:}},e.prototype.errorHandler=function(t){console.log(t);var e=t.code,o=(e?e+": ":"")+t.message;void 0===e?this.reocredErrorCallback({message:c.sdkException,detail:o}):1101===e||1102===e||1103===e?this.reocredErrorCallback({message:c.noSupportRecord,detail:o}):1104===e||1105===e||1106===e?this.reocredErrorCallback({message:c.networkException,detail:o}):4003===e?this.reocredErrorCallback({message:c.recordTimeout,detail:o}):this.reocredErrorCallback({message:c.recordFailed,detail:o})},e.prototype.recorderReadyCallback=function(){this.sendMessage({code:u.EventList.recorderReady,message:this.frame+"录音准备就绪"})},e.prototype.startRecordCallback=function(){console.log("开始录音")},e.prototype.finishRecordCallback=function(t){var e=t.overall,o=t.tipId,i=t.rec,n=t.recordDuration;this.sendMessage({code:u.EventList.sendRecordResult,data:{score:e,rec:i,recordDuration:n,frame:this.frame,tipId:o},message:this.frame+"录音结束",level:"info"})},e.prototype.reocredErrorCallback=function(t){var e=this.frame+"录音失败";this.sendMessage({code:u.EventList.recordError,data:this,message:e,level:"info"}),this.sendError({code:u.EventList.recordError,message:e,data:{frame:this.frame,error:t}})},e}(u.ClassRoomObject);e.Recorder=h},409:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Student=void 0;var a=o(627),c=o(141),u=o(483),l=function(t){function e(){var e=t.call(this)||this;return e.noFaceTime=0,e.isHaveFace=a.FACESTATUS.NOFACE,e.noFaceThreshold=5,e.video=new vf.gui.Video,e.video.autoplay=!0,e.video.visible=!1,e.addChild(e.video),e}return n(e,t),Object.defineProperty(e,"Ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){var t,o,i,n=this;return s(this,(function(r){switch(r.label){case 0:return(t=this.myoteeMicrophone=new u.MyoteeMicrophone).setStatus(this.stage,this.status,this.container),t.onLoad(),this.addChild(t),this.status.camera?(i=this.status,[4,this.openMedia()]):(setTimeout((function(){n.emit(e.loadCompleteEvent,n.status.camera)}),20),[2]);case 1:return(o=i.camera=r.sent())?(this.faceOptions=new c.TinyFaceDetectorOptions({inputSize:224,scoreThreshold:.5}),[4,this.loadModelRes()]):[3,3];case 2:return r.sent(),this.video.visible=!0,this.emit(e.loadCompleteEvent,o),[3,4];case 3:setTimeout((function(){n.emit(e.loadCompleteEvent,o)}),20),r.label=4;case 4:return[2]}}))}))},e.prototype.loadModelRes=function(){return r(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return"https://s.vipkidstatic.com/fe-static/vf-thunder/assets",[4,Promise.all([c.loadTinyFaceDetectorModel("https://s.vipkidstatic.com/fe-static/vf-thunder/assets/models")]).catch((function(t){console.error(t)}))];case 1:return t.sent(),[2]}}))}))},e.prototype.checkFaceExpressions=function(){return r(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return void 0===this.faceOptions?[2,void 0]:[4,c.detectSingleFace(this.video.videoElement,this.faceOptions).withFaceExpressions()];case 1:return(t=e.sent())?[2,t]:[2,void 0]}}))}))},e.prototype.checkFace=function(){return r(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return void 0===this.faceOptions?(this.isHaveFace=a.FACESTATUS.NOFACE,this.status.isHaveFace=a.FACESTATUS.NOFACE,[2,this.isHaveFace]):[4,c.detectSingleFace(this.video.videoElement,this.faceOptions)];case 1:return t.sent()?(this.noFaceTime=0,this.myoteeMicrophone&&this.myoteeMicrophone.checkFace(void 0),this.isHaveFace||(console.log("脸回来了"),this.isHaveFace=a.FACESTATUS.FACEBACK,this.status.isHaveFace=a.FACESTATUS.FACEBACK,this.controller.dispatch({code:a.EventList.face,data:{isHaveFace:a.FACESTATUS.FACEBACK},level:"command"}))):(this.noFaceTime++,this.noFaceTime===this.noFaceThreshold&&(console.log("无脸"),this.isHaveFace=a.FACESTATUS.NOFACE,this.status.isHaveFace=a.FACESTATUS.NOFACE,this.noFaceTime=0,this.controller.dispatch({code:a.EventList.face,data:{isHaveFace:a.FACESTATUS.NOFACE},level:"command"}))),[2,this.isHaveFace]}}))}))},e.prototype.release=function(){t.prototype.release.call(this),this.offAll(),this.closeMedia(),this.video.release()},e.prototype.updateDisplayList=function(t,e){this.video.width=t,this.video.height=e},e.prototype.checkMedia=function(){var t=vf.utils.getSystemInfo().browser;if("Safari"===t.name)switch(parseInt(t.version)){case 11:this.openMedia()}},e.prototype.openMedia=function(){return r(this,void 0,void 0,(function(){var t,e,o,i,n;return s(this,(function(r){switch(r.label){case 0:if(t=vf.utils.getSystemInfo().browser,e=320,o=240,"Safari"===t.name)switch(parseInt(t.version)){case 11:case 12:e=640,o=480}return i={audio:!1,video:{width:e,height:o,frameRate:12}},void 0===navigator.mediaDevices?[2,!1]:void 0===navigator.mediaDevices.getUserMedia?[2,!1]:(n=this,[4,navigator.mediaDevices.getUserMedia(i).catch(this.onCameraFail.bind(this))]);case 1:return n.stream=r.sent(),this.stream?(this.video.src=this.stream,[2,!0]):[2,!1]}}))}))},e.prototype.onCameraFail=function(t){this.sendError({code:a.EventList.openCameraError,data:t,message:"摄像头打开失败"})},e.prototype.closeMedia=function(){this.stream&&this.stream.getVideoTracks().forEach((function(t){t.stop()})),this.video.pause()},e.loadCompleteEvent="loadComplete",e}(a.BaseObject);e.Student=l},483:function(t,e,o){var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))((function(n,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.MyoteeMicrophone=void 0;var a=function(t){function e(){var e=t.call(this)||this;return e.sp=new vf.gui.SpriteAnimated,e.sp.autoPlay=!0,e.sp.loop=!0,e.loader=new vf.Loader,e.addChild(e.sp),e.visible=!1,e}return n(e,t),e.prototype.onLoad=function(){return r(this,void 0,void 0,(function(){return s(this,(function(t){return this.status.on("myotee",this.onMyoteeChange,this),this.onMyoteeChange(this.status.myotee,void 0),[2]}))}))},e.prototype.onMyoteeChange=function(t,e){void 0!==t?e!==t&&(this.sp.animationName=t.animationName,this.status.res[t.name]&&(this.sp.src=this.status.res[t.name].spritesheet,this.show())):this.hide()},e.prototype.show=function(){this.sp.src&&(this.visible=!0,this.x=100,this.y=130)},e.prototype.hide=function(){this.sp._lastAnimatedName="",this.sp.src=void 0,this.visible=!1},e.prototype.checkFace=function(t){this.visible=!0},e.prototype.release=function(){t.prototype.release.call(this),this.offAll(),this.status.off("myotee",this.onMyoteeChange,this),this.sp.releaseAll(),this.loader.destroy()},e}(o(627).BaseObject);e.MyoteeMicrophone=a},141:function(t){t.exports=faceapi}},e={};return function o(i){if(e[i])return e[i].exports;var n=e[i]={exports:{}};return t[i].call(n.exports,n,n.exports,o),n.exports}(895)}();